{"version":3,"file":"vue-authenticate.es.js","sources":["../src/utils.js","../src/globals.js","../src/options.js","../src/storage/cookie-storage.js","../src/storage/local-storage.js","../src/storage/memory-storage.js","../src/storage/session-storage.js","../src/storage.js","../src/oauth/popup.js","../src/oauth/oauth1.js","../src/oauth/oauth2.js","../src/authenticate.js","../src/index.js"],"sourcesContent":["if (typeof Object.assign !== 'function') {\n  Object.assign = function (target, varArgs) {\n    'use strict';\n    if (target === null) {\n      throw new TypeError('Cannot convert undefined or null to object');\n    }\n\n    const to = Object(target);\n\n    for (let index = 1; index < arguments.length; index++) {\n      const nextSource = arguments[index];\n\n      if (nextSource !== null) {\n        // Skip over if undefined or null\n        for (const nextKey in nextSource) {\n          // Avoid bugs when hasOwnProperty is shadowed\n          if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n            to[nextKey] = nextSource[nextKey];\n          }\n        }\n      }\n    }\n    return to;\n  };\n}\n\nexport function camelCase (name) {\n  return name.replace(/([\\:\\-\\_]+(.))/g, function (\n    _,\n    separator,\n    letter,\n    offset\n  ) {\n    return offset ? letter.toUpperCase() : letter;\n  });\n}\n\nexport function isUndefined (value) {\n  return typeof value === 'undefined';\n}\n\nexport function isDefined (value) {\n  return typeof value !== 'undefined';\n}\n\nexport function isObject (value) {\n  return value !== null && typeof value === 'object';\n}\n\nexport function isString (value) {\n  return typeof value === 'string';\n}\n\nexport function isNumber (value) {\n  return typeof value === 'number';\n}\n\nexport function isFunction (value) {\n  return typeof value === 'function';\n}\n\nexport function objectExtend (a, b) {\n  // Don't touch 'null' or 'undefined' objects.\n  if (a == null || b == null) {\n    return a;\n  }\n\n  Object.keys(b).forEach(function (key) {\n    if (Object.prototype.toString.call(b[key]) === '[object Object]') {\n      if (Object.prototype.toString.call(a[key]) !== '[object Object]') {\n        a[key] = b[key];\n      } else {\n        a[key] = objectExtend(a[key], b[key]);\n      }\n    } else {\n      a[key] = b[key];\n    }\n  });\n\n  return a;\n}\n\n/**\n * Assemble url from two segments\n *\n * @author Sahat Yalkabov <https://github.com/sahat>\n * @copyright Method taken from https://github.com/sahat/satellizer\n *\n * @param  {String} baseUrl Base url\n * @param  {String} url     URI\n * @return {String}\n */\nexport function joinUrl (baseUrl, url) {\n  if (/^(?:[a-z]+:)?\\/\\//i.test(url)) {\n    return url;\n  }\n  const joined = [baseUrl, url].join('/');\n  const normalize = function (str) {\n    return str\n      .replace(/[\\/]+/g, '/')\n      .replace(/\\/\\?/g, '?')\n      .replace(/\\/\\#/g, '#')\n      .replace(/\\:\\//g, '://');\n  };\n  return normalize(joined);\n}\n\n/**\n * Get full path based on current location\n *\n * @author Sahat Yalkabov <https://github.com/sahat>\n * @copyright Method taken from https://github.com/sahat/satellizer\n *\n * @param  {Location} location\n * @return {String}\n */\nexport function getFullUrlPath (location) {\n  const isHttps = location.protocol === 'https:';\n  return (\n    location.protocol +\n    '//' +\n    location.hostname +\n    ':' +\n    (location.port || (isHttps ? '443' : '80')) +\n    (/^\\//.test(location.pathname)\n      ? location.pathname\n      : '/' + location.pathname)\n  );\n}\n\n/**\n * Parse query string variables\n *\n * @author Sahat Yalkabov <https://github.com/sahat>\n * @copyright Method taken from https://github.com/sahat/satellizer\n *\n * @param  {String} Query string\n * @return {String}\n */\nexport function parseQueryString (str) {\n  const obj = {};\n  let key;\n  let value;\n  (str || '').split('&').forEach(keyValue => {\n    if (keyValue) {\n      value = keyValue.split('=');\n      key = decodeURIComponent(value[0]);\n      obj[key] = value[1] ? decodeURIComponent(value[1]) : true;\n    }\n  });\n  return obj;\n}\n\n/**\n * Decode base64 string\n * @author Sahat Yalkabov <https://github.com/sahat>\n * @copyright Method taken from https://github.com/sahat/satellizer\n *\n * @param  {String} str base64 encoded string\n * @return {Object}\n */\nexport function decodeBase64 (str) {\n  let buffer;\n  if (typeof module !== 'undefined' && module.exports) {\n    try {\n      buffer = require('buffer').Buffer;\n    } catch (err) {\n      // noop\n    }\n  }\n\n  const fromCharCode = String.fromCharCode;\n\n  const reBtou = new RegExp(\n    [\n      '[\\xC0-\\xDF][\\x80-\\xBF]',\n      '[\\xE0-\\xEF][\\x80-\\xBF]{2}',\n      '[\\xF0-\\xF7][\\x80-\\xBF]{3}'\n    ].join('|'),\n    'g'\n  );\n\n  const cbBtou = function (cccc) {\n    switch (cccc.length) {\n    case 4: {\n      const cp =\n            ((0x07 & cccc.charCodeAt(0)) << 18) |\n            ((0x3f & cccc.charCodeAt(1)) << 12) |\n            ((0x3f & cccc.charCodeAt(2)) << 6) |\n            (0x3f & cccc.charCodeAt(3));\n      const offset = cp - 0x10000;\n      return (\n        fromCharCode((offset >>> 10) + 0xd800) +\n            fromCharCode((offset & 0x3ff) + 0xdc00)\n      );\n    }\n    case 3: {\n      return fromCharCode(\n        ((0x0f & cccc.charCodeAt(0)) << 12) |\n              ((0x3f & cccc.charCodeAt(1)) << 6) |\n              (0x3f & cccc.charCodeAt(2))\n      );\n    }\n    default: {\n      return fromCharCode(\n        ((0x1f & cccc.charCodeAt(0)) << 6) | (0x3f & cccc.charCodeAt(1))\n      );\n    }\n    }\n  };\n\n  const btou = function (b) {\n    return b.replace(reBtou, cbBtou);\n  };\n\n  const _decode = buffer\n    ? function (a) {\n      return (a.constructor === buffer.constructor\n        ? a\n        : buffer.Buffer.alloc(a, 'base64')\n      ).toString();\n    }\n    : function (a) {\n      return btou(atob(a));\n    };\n\n  return _decode(\n    String(str)\n      .replace(/[-_]/g, function (m0) {\n        return m0 === '-' ? '+' : '/';\n      })\n      .replace(/[^A-Za-z0-9\\+\\/]/g, '')\n  );\n}\n\nexport function parseCookies (str = '') {\n  if (str.length === 0) return {};\n  const parsed = {};\n  const pattern = new RegExp('\\\\s*;\\\\s*');\n  str.split(pattern).forEach(i => {\n    const [encodedKey, encodedValue] = i.split('=');\n    const key = decodeURIComponent(encodedKey);\n    const value = decodeURIComponent(encodedValue);\n    parsed[key] = value;\n  });\n  return parsed;\n}\n\nexport function formatOptions (options) {\n  const { path, domain, expires, secure } = options;\n  return [\n    typeof path === 'undefined' || path === null ? '' : ';path=' + path,\n    typeof domain === 'undefined' || domain === null ? '' : ';domain=' + domain,\n    typeof expires === 'undefined' || expires === null\n      ? ''\n      : ';expires=' + expires.toUTCString(),\n    typeof secure === 'undefined' || secure === null || secure === false\n      ? ''\n      : ';secure'\n  ].join('');\n}\n\nexport function formatCookie (key, value, options) {\n  return [\n    encodeURIComponent(key),\n    '=',\n    encodeURIComponent(value),\n    formatOptions(options)\n  ].join('');\n}\n\nexport function getObjectProperty (objectRef, propertyName) {\n  let value;\n  let valueRef = objectRef;\n  const propNames = propertyName.split('.');\n\n  for (let i = 0; i < propNames.length; i++) {\n    const key = propNames[i];\n    value = valueRef[key];\n\n    if (isObject(value)) {\n      valueRef = valueRef[key];\n    } else {\n      break;\n    }\n  }\n\n  return value;\n}\n","const fakeDocument = {\n  createElement () { }\n};\n\nconst fakeWindow = {\n  atob () { },\n  open () { },\n  location: {},\n  localStorage: {\n    setItem () { },\n    getItem () { },\n    removeItem () { }\n  },\n  sessionStorage: {\n    setItem () { },\n    getItem () { },\n    removeItem () { }\n  }\n};\n\nexport const $document = (typeof document !== 'undefined')\n  ? document\n  : fakeDocument;\n\nexport const $window = (typeof window !== 'undefined')\n  ? window\n  : fakeWindow;\n","import { isUndefined } from './utils';\nimport { $window } from './globals';\n\nexport function getCookieDomainUrl () {\n  try {\n    return $window.location.hostname;\n  } catch (error) {}\n\n  return '';\n}\n\nexport function getRedirectUri (uri) {\n  try {\n    return !isUndefined(uri)\n      ? `${$window.location.origin}${uri}`\n      : $window.location.origin;\n  } catch (error) {}\n\n  return uri || null;\n}\n\n/**\n * Default configuration\n */\nexport default {\n  baseUrl: null,\n  tokenPath: 'access_token',\n  tokenName: 'token',\n  tokenPrefix: 'vueauth',\n  tokenHeader: 'Authorization',\n  tokenType: 'Bearer',\n  loginUrl: '/auth/login',\n  registerUrl: '/auth/register',\n  logoutUrl: null,\n  storageType: 'localStorage',\n  storageNamespace: 'vue-authenticate',\n  cookieStorage: {\n    domain: getCookieDomainUrl(),\n    path: '/',\n    secure: false\n  },\n  requestDataKey: 'data',\n  responseDataKey: 'data',\n\n  /**\n   * Default request interceptor for Axios library\n   * @context {VueAuthenticate}\n   */\n  bindRequestInterceptor: function ($auth) {\n    const tokenHeader = $auth.options.tokenHeader;\n\n    $auth.$http.interceptors.request.use(config => {\n      if ($auth.isAuthenticated()) {\n        config.headers[tokenHeader] = [\n          $auth.options.tokenType,\n          $auth.getToken()\n        ].join(' ');\n      } else {\n        delete config.headers[tokenHeader];\n      }\n      return config;\n    });\n  },\n\n  providers: {\n    facebook: {\n      name: 'facebook',\n      url: '/auth/facebook',\n      authorizationEndpoint: 'https://www.facebook.com/v12.0/dialog/oauth',\n      redirectUri: getRedirectUri('/'),\n      requiredUrlParams: ['display', 'scope'],\n      scope: ['email'],\n      scopeDelimiter: ',',\n      display: 'popup',\n      oauthType: '2.0',\n      popupOptions: { width: 580, height: 400 }\n    },\n\n    google: {\n      name: 'google',\n      url: '/auth/google',\n      authorizationEndpoint: 'https://accounts.google.com/o/oauth2/auth',\n      redirectUri: getRedirectUri(),\n      requiredUrlParams: ['scope'],\n      optionalUrlParams: ['display'],\n      scope: ['profile', 'email'],\n      scopePrefix: 'openid',\n      scopeDelimiter: ' ',\n      display: 'popup',\n      oauthType: '2.0',\n      popupOptions: { width: 452, height: 633 }\n    },\n\n    github: {\n      name: 'github',\n      url: '/auth/github',\n      authorizationEndpoint: 'https://github.com/login/oauth/authorize',\n      redirectUri: getRedirectUri(),\n      optionalUrlParams: ['scope'],\n      scope: ['user:email'],\n      scopeDelimiter: ' ',\n      oauthType: '2.0',\n      popupOptions: { width: 1020, height: 618 }\n    },\n\n    instagram: {\n      name: 'instagram',\n      url: '/auth/instagram',\n      authorizationEndpoint: 'https://api.instagram.com/oauth/authorize',\n      redirectUri: getRedirectUri(),\n      requiredUrlParams: ['scope'],\n      scope: ['basic'],\n      scopeDelimiter: '+',\n      oauthType: '2.0',\n      popupOptions: { width: null, height: null }\n    },\n\n    twitter: {\n      name: 'twitter',\n      url: '/auth/twitter',\n      authorizationEndpoint: 'https://api.twitter.com/oauth/authenticate',\n      redirectUri: getRedirectUri(),\n      oauthType: '1.0',\n      popupOptions: { width: 495, height: 645 }\n    },\n\n    bitbucket: {\n      name: 'bitbucket',\n      url: '/auth/bitbucket',\n      authorizationEndpoint: 'https://bitbucket.org/site/oauth2/authorize',\n      redirectUri: getRedirectUri('/'),\n      optionalUrlParams: ['scope'],\n      scope: ['email'],\n      scopeDelimiter: ' ',\n      oauthType: '2.0',\n      popupOptions: { width: 1020, height: 618 }\n    },\n\n    linkedin: {\n      name: 'linkedin',\n      url: '/auth/linkedin',\n      authorizationEndpoint: 'https://www.linkedin.com/oauth/v2/authorization',\n      redirectUri: getRedirectUri(),\n      requiredUrlParams: ['state'],\n      scope: ['r_emailaddress'],\n      scopeDelimiter: ' ',\n      state: 'STATE',\n      oauthType: '2.0',\n      popupOptions: { width: 527, height: 582 }\n    },\n\n    live: {\n      name: 'live',\n      url: '/auth/live',\n      authorizationEndpoint: 'https://login.live.com/oauth20_authorize.srf',\n      redirectUri: getRedirectUri(),\n      requiredUrlParams: ['display', 'scope'],\n      scope: ['wl.emails'],\n      scopeDelimiter: ' ',\n      display: 'popup',\n      oauthType: '2.0',\n      popupOptions: { width: 500, height: 560 }\n    },\n\n    oauth1: {\n      name: null,\n      url: '/auth/oauth1',\n      authorizationEndpoint: null,\n      redirectUri: getRedirectUri(),\n      oauthType: '1.0',\n      popupOptions: null\n    },\n\n    oauth2: {\n      name: null,\n      url: '/auth/oauth2',\n      clientId: null,\n      redirectUri: getRedirectUri(),\n      authorizationEndpoint: null,\n      defaultUrlParams: ['response_type', 'client_id', 'redirect_uri'],\n      requiredUrlParams: null,\n      optionalUrlParams: null,\n      scope: null,\n      scopePrefix: null,\n      scopeDelimiter: null,\n      state: null,\n      oauthType: '2.0',\n      popupOptions: null,\n      responseType: 'code',\n      responseParams: {\n        code: 'code',\n        clientId: 'clientId',\n        redirectUri: 'redirectUri'\n      }\n    }\n  }\n};\n","import { $document } from '../globals.js';\nimport { objectExtend, formatCookie, parseCookies } from '../utils.js';\nimport { getCookieDomainUrl } from '../options.js';\n\nclass CookieStorage {\n  constructor (defaultOptions) {\n    this._defaultOptions = objectExtend(\n      {\n        domain: getCookieDomainUrl(),\n        expires: null,\n        path: '/',\n        secure: false\n      },\n      defaultOptions\n    );\n  }\n\n  setItem (key, value) {\n    const options = objectExtend({}, this._defaultOptions);\n    const cookie = formatCookie(key, value, options);\n    this._setCookie(cookie);\n  }\n\n  getItem (key) {\n    const cookies = parseCookies(this._getCookie());\n    return cookies.hasOwnProperty(key) ? cookies[key] : null;\n  }\n\n  removeItem (key) {\n    const value = '';\n    const defaultOptions = objectExtend({}, this._defaultOptions);\n    const options = objectExtend(defaultOptions, {\n      expires: new Date(0)\n    });\n    const cookie = formatCookie(key, value, options);\n    this._setCookie(cookie);\n  }\n\n  _getCookie () {\n    try {\n      return $document.cookie === 'undefined' ? '' : $document.cookie;\n    } catch (error) {}\n\n    return '';\n  }\n\n  _setCookie (cookie) {\n    try {\n      $document.cookie = cookie;\n    } catch (error) {}\n  }\n}\n\nexport default CookieStorage;\n","import { $window } from '../globals.js';\n\nclass LocalStorage {\n  constructor (namespace) {\n    this.namespace = namespace || null;\n  }\n\n  setItem (key, value) {\n    $window.localStorage.setItem(this._getStorageKey(key), value);\n  }\n\n  getItem (key) {\n    return $window.localStorage.getItem(this._getStorageKey(key));\n  }\n\n  removeItem (key) {\n    $window.localStorage.removeItem(this._getStorageKey(key));\n  }\n\n  _getStorageKey (key) {\n    if (this.namespace) {\n      return [this.namespace, key].join('.');\n    }\n    return key;\n  }\n}\n\nexport default LocalStorage;\n","class MemoryStorage {\n  constructor (namespace) {\n    this.namespace = namespace || null;\n    this._storage = {};\n  }\n\n  setItem (key, value) {\n    this._storage[this._getStorageKey(key)] = value;\n  }\n\n  getItem (key) {\n    return this._storage[this._getStorageKey(key)];\n  }\n\n  removeItem (key) {\n    delete this._storage[this._getStorageKey(key)];\n  }\n\n  _getStorageKey (key) {\n    if (this.namespace) {\n      return [this.namespace, key].join('.');\n    }\n    return key;\n  }\n}\n\nexport default MemoryStorage;\n","import { $window } from '../globals.js';\n\nclass SessionStorage {\n  constructor (namespace) {\n    this.namespace = namespace || null;\n  }\n\n  setItem (key, value) {\n    $window.sessionStorage.setItem(this._getStorageKey(key), value);\n  }\n\n  getItem (key) {\n    return $window.sessionStorage.getItem(this._getStorageKey(key));\n  }\n\n  removeItem (key) {\n    $window.sessionStorage.removeItem(this._getStorageKey(key));\n  }\n\n  _getStorageKey (key) {\n    if (this.namespace) {\n      return [this.namespace, key].join('.');\n    }\n    return key;\n  }\n}\n\nexport default SessionStorage;\n","import { $window } from './globals';\nimport CookieStorage from './storage/cookie-storage.js';\nimport LocalStorage from './storage/local-storage.js';\nimport MemoryStorage from './storage/memory-storage.js';\nimport SessionStorage from './storage/session-storage.js';\n\nexport default function StorageFactory (options) {\n  switch (options.storageType) {\n  case 'localStorage':\n    try {\n      $window.localStorage.setItem('testKey', 'test');\n      $window.localStorage.removeItem('testKey');\n      return new LocalStorage(options.storageNamespace);\n    } catch (error) {}\n    break;\n  case 'sessionStorage':\n    try {\n      $window.sessionStorage.setItem('testKey', 'test');\n      $window.sessionStorage.removeItem('testKey');\n      return new SessionStorage(options.storageNamespace);\n    } catch (error) {}\n    break;\n  case 'cookieStorage':\n    return new CookieStorage(options.cookieStorage);\n\n  case 'memoryStorage':\n  default:\n    return new MemoryStorage(options.storageNamespace);\n  }\n}\n","import { $document, $window } from '../globals.js';\nimport {\n  objectExtend,\n  parseQueryString,\n  getFullUrlPath,\n  isUndefined\n} from '../utils.js';\n\n/**\n * OAuth2 popup management class\n *\n * @author Sahat Yalkabov <https://github.com/sahat>\n * @copyright Class mostly taken from https://github.com/sahat/satellizer\n * and adjusted to fit vue-authenticate library\n */\nexport default class OAuthPopup {\n  constructor (url, name, popupOptions) {\n    this.popup = null;\n    this.url = url;\n    this.name = name;\n    this.popupOptions = popupOptions;\n  }\n\n  async open (redirectUri, skipPooling) {\n    try {\n      this.popup = $window.open(this.url, this.name, this._stringifyOptions());\n      if (this.popup && this.popup.focus) {\n        this.popup.focus();\n      }\n\n      if (!skipPooling) {\n        return this.pooling(redirectUri);\n      }\n    } catch (error) {\n      throw new Error('OAuth popup error occurred');\n    }\n  }\n\n  async pooling (redirectUri) {\n    // promise needed here to be able to return result of popup window,\n    // from interval\n    return new Promise((resolve, reject) => {\n      const redirectUriParser = $document.createElement('a');\n      redirectUriParser.href = redirectUri;\n      const redirectUriPath = getFullUrlPath(redirectUriParser);\n\n      let poolingInterval = setInterval(() => {\n        if (\n          !this.popup ||\n          this.popup.closed ||\n          this.popup.closed === undefined\n        ) {\n          clearInterval(poolingInterval);\n          poolingInterval = null;\n          reject(new Error('Auth popup window closed'));\n        }\n\n        try {\n          const popupWindowPath = getFullUrlPath(this.popup.location);\n\n          if (popupWindowPath === redirectUriPath) {\n            if (this.popup.location.search || this.popup.location.hash) {\n              const query = parseQueryString(\n                this.popup.location.search.substring(1).replace(/\\/$/, '')\n              );\n              const hash = parseQueryString(\n                this.popup.location.hash.substring(1).replace(/[\\/$]/, '')\n              );\n              let params = objectExtend({}, query);\n              params = objectExtend(params, hash);\n\n              if (params.error) {\n                reject(new Error(params.error));\n              } else {\n                resolve(params);\n              }\n\n              clearInterval(poolingInterval);\n              poolingInterval = null;\n              this.popup.close();\n            } else {\n              reject(new Error(\n                'OAuth redirect has occurred but no query or hash parameters were found.'\n              )\n              );\n            }\n          }\n        } catch (error) {\n          // Ignore DOMException: Blocked a frame with origin from accessing a cross-origin frame.\n        }\n      }, 250);\n    });\n  }\n\n  _stringifyOptions () {\n    const options = [];\n    for (const optionKey in this.popupOptions) {\n      if (!isUndefined(this.popupOptions[optionKey])) {\n        options.push(`${optionKey}=${this.popupOptions[optionKey]}`);\n      }\n    }\n    return options.join(',');\n  }\n}\n","import OAuthPopup from './popup.js';\nimport { $window } from '../globals.js';\nimport {\n  objectExtend,\n  joinUrl\n} from '../utils.js';\n\nconst defaultProviderConfig = {\n  name: null,\n  url: null,\n  authorizationEndpoint: null,\n  scope: null,\n  scopePrefix: null,\n  scopeDelimiter: null,\n  redirectUri: null,\n  requiredUrlParams: null,\n  defaultUrlParams: null,\n  oauthType: '1.0',\n  popupOptions: {}\n};\n\nexport default class OAuth {\n  constructor ($http, storage, providerConfig, options) {\n    this.$http = $http;\n    this.storage = storage;\n    this.providerConfig = objectExtend({}, defaultProviderConfig);\n    this.providerConfig = objectExtend(this.providerConfig, providerConfig);\n    this.options = options;\n  }\n\n  /**\n   * Initialize OAuth1 process\n   * @param  {Object} userData User data\n   * @return {Promise}\n   */\n  async init (userData) {\n    this.oauthPopup = new OAuthPopup(\n      'about:blank',\n      this.providerConfig.name,\n      this.providerConfig.popupOptions\n    );\n\n    if (!$window.cordova) {\n      this.oauthPopup.open(this.providerConfig.redirectUri, true);\n    }\n\n    const response = await this.getRequestToken();\n    const popupResponse = await this.openPopup(response);\n    return this.exchangeForToken(popupResponse, userData);\n  }\n\n  /**\n   * Get OAuth1 request token\n   * @return {Promise}\n   */\n  async getRequestToken () {\n    const requestOptions = {};\n    requestOptions.method = 'POST';\n    requestOptions[this.options.requestDataKey] = objectExtend(\n      {},\n      this.providerConfig\n    );\n    requestOptions.withCredentials = this.options.withCredentials;\n    if (this.options.baseUrl) {\n      requestOptions.url = joinUrl(\n        this.options.baseUrl,\n        this.providerConfig.url\n      );\n    } else {\n      requestOptions.url = this.providerConfig.url;\n    }\n\n    return this.$http(requestOptions);\n  }\n\n  /**\n   * Open OAuth1 popup\n   * @param  {Object} response Response object containing request token\n   * @return {Promise}\n   */\n  async openPopup (response) {\n    const url = [\n      this.providerConfig.authorizationEndpoint,\n      this.buildQueryString(response[this.options.responseDataKey])\n    ].join('?');\n\n    this.oauthPopup.popup.location = url;\n    if ($window.cordova) {\n      return this.oauthPopup.open(this.providerConfig.redirectUri);\n    } else {\n      return this.oauthPopup.pooling(this.providerConfig.redirectUri);\n    }\n  }\n\n  /**\n   * Exchange token and token verifier for access token\n   * @param  {Object} oauth    OAuth data containing token and token verifier\n   * @param  {Object} userData User data\n   * @return {Promise}\n   */\n  async exchangeForToken (oauth, userData) {\n    let payload = objectExtend({}, userData);\n    payload = objectExtend(payload, oauth);\n    const requestOptions = {};\n    requestOptions.method = 'POST';\n    requestOptions[this.options.requestDataKey] = payload;\n    requestOptions.withCredentials = this.options.withCredentials;\n    if (this.options.baseUrl) {\n      requestOptions.url = joinUrl(\n        this.options.baseUrl,\n        this.providerConfig.url\n      );\n    } else {\n      requestOptions.url = this.providerConfig.url;\n    }\n    return this.$http(requestOptions);\n  }\n\n  buildQueryString (params) {\n    const parsedParams = [];\n    for (const key in params) {\n      const value = params[key];\n      parsedParams.push(\n        encodeURIComponent(key) + '=' + encodeURIComponent(value)\n      );\n    }\n    return parsedParams.join('&');\n  }\n}\n","import OAuthPopup from './popup.js';\nimport {\n  camelCase,\n  isFunction,\n  isString,\n  objectExtend,\n  joinUrl\n} from '../utils.js';\n\n/**\n * Default provider configuration\n * @type {Object}\n */\nconst defaultProviderConfig = {\n  name: null,\n  url: null,\n  clientId: null,\n  authorizationEndpoint: null,\n  redirectUri: null,\n  scope: null,\n  scopePrefix: null,\n  scopeDelimiter: null,\n  state: null,\n  requiredUrlParams: null,\n  defaultUrlParams: ['response_type', 'client_id', 'redirect_uri'],\n  responseType: 'code',\n  responseParams: {\n    code: 'code',\n    clientId: 'clientId',\n    redirectUri: 'redirectUri'\n  },\n  oauthType: '2.0',\n  popupOptions: {}\n};\n\nexport default class OAuth2 {\n  constructor ($http, storage, providerConfig, options) {\n    this.$http = $http;\n    this.storage = storage;\n    this.providerConfig = objectExtend({}, defaultProviderConfig);\n    this.providerConfig = objectExtend(this.providerConfig, providerConfig);\n    this.options = options;\n  }\n\n  async init (userData) {\n    const stateName = this.providerConfig.name + '_state';\n    if (isFunction(this.providerConfig.state)) {\n      this.storage.setItem(stateName, this.providerConfig.state());\n    } else if (isString(this.providerConfig.state)) {\n      this.storage.setItem(stateName, this.providerConfig.state);\n    }\n\n    const url = [\n      this.providerConfig.authorizationEndpoint,\n      this._stringifyRequestParams()\n    ].join('?');\n\n    const oauthPopup = new OAuthPopup(\n      url,\n      this.providerConfig.name,\n      this.providerConfig.popupOptions\n    );\n\n    const response = await oauthPopup.open(this.providerConfig.redirectUri);\n    if (\n      this.providerConfig.responseType === 'token' ||\n      !this.providerConfig.url\n    ) {\n      return response;\n    }\n\n    if (\n      response.state &&\n      response.state !== this.storage.getItem(stateName)\n    ) {\n      throw new Error(\n        'State parameter value does not match original OAuth request state value'\n      );\n    }\n\n    return this.exchangeForToken(response, userData);\n  }\n\n  /**\n   * Exchange temporary oauth data for access token\n   * @author Sahat Yalkabov <https://github.com/sahat>\n   * @copyright Method taken from https://github.com/sahat/satellizer\n   *\n   * @param  {[type]} oauth    [description]\n   * @param  {[type]} userData [description]\n   * @return {[type]}          [description]\n   */\n  exchangeForToken (oauth, userData) {\n    const payload = objectExtend({}, userData);\n\n    for (const key in this.providerConfig.responseParams) {\n      switch (key) {\n      case 'code':\n        payload[key] = oauth.code;\n        break;\n      case 'clientId':\n        payload[key] = this.providerConfig.clientId;\n        break;\n      case 'redirectUri':\n        payload[key] = this.providerConfig.redirectUri;\n        break;\n      default:\n        payload[key] = oauth[key];\n      }\n    }\n\n    if (oauth.state) {\n      payload.state = oauth.state;\n    }\n\n    let exchangeTokenUrl;\n    if (this.options.baseUrl) {\n      exchangeTokenUrl = joinUrl(this.options.baseUrl, this.providerConfig.url);\n    } else {\n      exchangeTokenUrl = this.providerConfig.url;\n    }\n\n    return this.$http.post(exchangeTokenUrl, payload, {\n      withCredentials: this.options.withCredentials\n    });\n  }\n\n  /**\n   * Stringify oauth params\n   * @author Sahat Yalkabov <https://github.com/sahat>\n   * @copyright Method taken from https://github.com/sahat/satellizer\n   *\n   * @return {String}\n   */\n  _stringifyRequestParams () {\n    const keyValuePairs = [];\n    const paramCategories = [\n      'defaultUrlParams',\n      'requiredUrlParams',\n      'optionalUrlParams'\n    ];\n\n    paramCategories.forEach(categoryName => {\n      if (!this.providerConfig[categoryName]) return;\n      if (!Array.isArray(this.providerConfig[categoryName])) return;\n\n      this.providerConfig[categoryName].forEach(paramName => {\n        const camelCaseParamName = camelCase(paramName);\n        let paramValue = isFunction(this.providerConfig[paramName])\n          ? this.providerConfig[paramName]()\n          : this.providerConfig[camelCaseParamName];\n\n        if (paramName === 'redirect_uri' && !paramValue) return;\n\n        if (paramName === 'state') {\n          const stateName = this.providerConfig.name + '_state';\n          paramValue = encodeURIComponent(this.storage.getItem(stateName));\n        }\n        if (paramName === 'scope' && Array.isArray(paramValue)) {\n          paramValue = paramValue.join(this.providerConfig.scopeDelimiter);\n          if (this.providerConfig.scopePrefix) {\n            paramValue = [this.providerConfig.scopePrefix, paramValue].join(\n              this.providerConfig.scopeDelimiter\n            );\n          }\n        }\n\n        keyValuePairs.push([paramName, paramValue]);\n      });\n    });\n\n    return keyValuePairs\n      .map(param => {\n        return param.join('=');\n      })\n      .join('&');\n  }\n}\n","import { $window } from './globals.js';\nimport {\n  objectExtend,\n  isFunction,\n  joinUrl,\n  decodeBase64,\n  getObjectProperty\n} from './utils.js';\nimport defaultOptions from './options.js';\nimport StorageFactory from './storage.js';\nimport OAuth1 from './oauth/oauth1.js';\nimport OAuth2 from './oauth/oauth2.js';\n\nexport default class VueAuthenticate {\n  constructor ($http, overrideOptions) {\n    let options = objectExtend({}, defaultOptions);\n    options = objectExtend(options, overrideOptions);\n    const storage = StorageFactory(options);\n\n    Object.defineProperties(this, {\n      $http: {\n        get () {\n          return $http;\n        }\n      },\n\n      options: {\n        get () {\n          return options;\n        }\n      },\n\n      storage: {\n        get () {\n          return storage;\n        }\n      },\n\n      tokenName: {\n        get () {\n          if (this.options.tokenPrefix) {\n            return [this.options.tokenPrefix, this.options.tokenName].join('_');\n          } else {\n            return this.options.tokenName;\n          }\n        }\n      }\n    });\n\n    // Setup request interceptors\n    if (\n      this.options.bindRequestInterceptor &&\n      isFunction(this.options.bindRequestInterceptor)\n    ) {\n      this.options.bindRequestInterceptor.call(this, this);\n    } else {\n      throw new Error('Request interceptor must be functions');\n    }\n  }\n\n  /**\n   * Check if user is authenticated\n   * @author Sahat Yalkabov <https://github.com/sahat>\n   * @copyright Method taken from https://github.com/sahat/satellizer\n   * @return {Boolean}\n   */\n  isAuthenticated () {\n    const token = this.storage.getItem(this.tokenName);\n\n    if (token) {\n      // Token is present\n      if (token.split('.').length === 3) {\n        // Token with a valid JWT format XXX.YYY.ZZZ\n        try {\n          // Could be a valid JWT or an access token with the same format\n          const base64Url = token.split('.')[1];\n          const base64 = base64Url.replace('-', '+').replace('_', '/');\n          const exp = JSON.parse($window.atob(base64)).exp;\n          if (typeof exp === 'number') {\n            // JWT with an optonal expiration claims\n            return Math.round(new Date().getTime() / 1000) < exp;\n          }\n        } catch (error) {\n          return true; // Pass: Non-JWT token that looks like JWT\n        }\n      }\n      return true; // Pass: All other tokens\n    }\n    return false;\n  }\n\n  /**\n   * Get token if user is authenticated\n   * @return {String} Authentication token\n   */\n  getToken () {\n    return this.storage.getItem(this.tokenName);\n  }\n\n  /**\n   * Set new authentication token\n   * @param {String|Object} token\n   */\n  setToken (response, tokenPath) {\n    if (response[this.options.responseDataKey]) {\n      response = response[this.options.responseDataKey];\n    }\n\n    const responseTokenPath = tokenPath || this.options.tokenPath;\n    const token = getObjectProperty(response, responseTokenPath);\n\n    if (token) {\n      this.storage.setItem(this.tokenName, token);\n    }\n  }\n\n  getPayload () {\n    const token = this.storage.getItem(this.tokenName);\n\n    if (token && token.split('.').length === 3) {\n      try {\n        const base64Url = token.split('.')[1];\n        const base64 = base64Url.replace('-', '+').replace('_', '/');\n        return JSON.parse(decodeBase64(base64));\n      } catch (error) {}\n    }\n  }\n\n  /**\n   * Login user using email and password\n   * @param  {Object} user           User data\n   * @param  {Object} requestOptions Request options\n   * @return {Promise}               Request promise\n   */\n  async login (user, requestOptions) {\n    requestOptions = requestOptions || {};\n    requestOptions.url = requestOptions.url\n      ? requestOptions.url\n      : joinUrl(this.options.baseUrl, this.options.loginUrl);\n    requestOptions[this.options.requestDataKey] =\n      user || requestOptions[this.options.requestDataKey];\n    requestOptions.method = requestOptions.method || 'POST';\n    requestOptions.withCredentials =\n      requestOptions.withCredentials || this.options.withCredentials;\n\n    const response = this.$http(requestOptions);\n    this.setToken(response);\n    return response;\n  }\n\n  /**\n   * Register new user\n   * @param  {Object} user           User data\n   * @param  {Object} requestOptions Request options\n   * @return {Promise}               Request promise\n   */\n  async register (user, requestOptions) {\n    requestOptions = requestOptions || {};\n    requestOptions.url = requestOptions.url\n      ? requestOptions.url\n      : joinUrl(this.options.baseUrl, this.options.registerUrl);\n    requestOptions[this.options.requestDataKey] =\n      user || requestOptions[this.options.requestDataKey];\n    requestOptions.method = requestOptions.method || 'POST';\n    requestOptions.withCredentials =\n      requestOptions.withCredentials || this.options.withCredentials;\n\n    const response = this.$http(requestOptions);\n    this.setToken(response);\n    return response;\n  }\n\n  /**\n   * Logout current user\n   * @param  {Object} requestOptions  Logout request options object\n   * @return {Promise}                Request promise\n   */\n  async logout (requestOptions) {\n    if (!this.isAuthenticated()) {\n      throw new Error('There is no currently authenticated user');\n    }\n\n    requestOptions = requestOptions || {};\n\n    if (requestOptions.url || this.options.logoutUrl) {\n      requestOptions.url = requestOptions.url\n        ? requestOptions.url\n        : joinUrl(this.options.baseUrl, this.options.logoutUrl);\n      requestOptions.method = requestOptions.method || 'POST';\n      requestOptions[this.options.requestDataKey] =\n        requestOptions[this.options.requestDataKey] || undefined;\n      requestOptions.withCredentials =\n        requestOptions.withCredentials || this.options.withCredentials;\n\n      const response = this.$http(requestOptions);\n      this.storage.removeItem(this.tokenName);\n      return response;\n    } else {\n      this.storage.removeItem(this.tokenName);\n    }\n  }\n\n  /**\n   * Authenticate user using authentication provider\n   *\n   * @param  {String} provider       Provider name\n   * @param  {Object} userData       User data\n   * @param  {Object} options        Options, to override provider config\n   * @return {Promise}               Request promise\n   */\n  async authenticate (provider, userData, options) {\n    let providerConfig = this.options.providers[provider];\n    if (!providerConfig) {\n      throw new Error('Unknown provider');\n    }\n\n    // support any options passed in, but don't modify the upstream\n    // provider config\n    providerConfig = Object.assign({}, providerConfig, options);\n\n    let providerInstance;\n    switch (providerConfig.oauthType) {\n    case '1.0':\n      providerInstance = new OAuth1(\n        this.$http,\n        this.storage,\n        providerConfig,\n        this.options\n      );\n      break;\n    case '2.0':\n      providerInstance = new OAuth2(\n        this.$http,\n        this.storage,\n        providerConfig,\n        this.options\n      );\n      break;\n    default:\n      throw new Error('Invalid OAuth type');\n    }\n\n    const response = await providerInstance.init(userData);\n    this.setToken(response, providerConfig.tokenPath);\n\n    if (this.isAuthenticated()) {\n      return response;\n    } else {\n      throw new Error('Authentication failed');\n    }\n  }\n\n  /**\n   * Link user using authentication provider without login\n   *\n   * @param  {String} provider       Provider name\n   * @param  {Object} userData       User data\n   * @param  {Object} options        Options, to override provider config\n   * @return {Promise}               Request promise\n   */\n  async link (provider, userData, options) {\n    let providerConfig = this.options.providers[provider];\n    if (!providerConfig) {\n      throw new Error('Unknown provider');\n    }\n\n    // support any options passed in, but don't modify the upstream\n    // provider config\n    providerConfig = Object.assign({}, providerConfig, options);\n\n    let providerInstance;\n    switch (providerConfig.oauthType) {\n    case '1.0':\n      providerInstance = new OAuth1(\n        this.$http,\n        this.storage,\n        providerConfig,\n        this.options\n      );\n      break;\n    case '2.0':\n      providerInstance = new OAuth2(\n        this.$http,\n        this.storage,\n        providerConfig,\n        this.options\n      );\n      break;\n    default:\n      throw new Error('Invalid OAuth type');\n    }\n\n    let response = providerInstance.init(userData);\n    if (response[this.options.responseDataKey]) {\n      response = response[this.options.responseDataKey];\n    }\n    return response;\n  }\n}\n","import './utils.js';\nimport VueAuthenticate from './authenticate.js';\n\nlet vueAuthInstance;\n\nconst VueAuthenticatePlugin = {\n  install (app, options) {\n    if (!options) {\n      options = {};\n    }\n\n    if (!vueAuthInstance) {\n      let axios = app.config.globalProperties.$http;\n      if (options.axios) {\n        axios = options.axios;\n      } else if (!axios) {\n        throw new Error('No axios instance found, as option or as vue global');\n      }\n\n      vueAuthInstance = new VueAuthenticate(axios, options);\n      app.config.globalProperties.$auth = vueAuthInstance;\n    }\n  }\n};\n\nexport default VueAuthenticatePlugin;\n"],"names":["target","varArgs","to","index","nextSource","nextKey","camelCase","name","_","separator","letter","offset","isUndefined","value","isObject","isString","isFunction","objectExtend","a","b","key","joinUrl","baseUrl","url","joined","str","getFullUrlPath","location","isHttps","parseQueryString","obj","keyValue","decodeBase64","buffer","fromCharCode","reBtou","cbBtou","cccc","btou","m0","parseCookies","parsed","pattern","i","encodedKey","encodedValue","formatOptions","options","path","domain","expires","secure","formatCookie","getObjectProperty","objectRef","propertyName","valueRef","propNames","fakeDocument","fakeWindow","$document","$window","getCookieDomainUrl","getRedirectUri","uri","defaultOptions","$auth","tokenHeader","config","CookieStorage","cookie","cookies","LocalStorage","namespace","MemoryStorage","SessionStorage","StorageFactory","OAuthPopup","popupOptions","redirectUri","skipPooling","resolve","reject","redirectUriParser","redirectUriPath","poolingInterval","query","hash","params","optionKey","defaultProviderConfig","OAuth","$http","storage","providerConfig","userData","response","popupResponse","requestOptions","oauth","payload","parsedParams","OAuth2","stateName","exchangeTokenUrl","keyValuePairs","categoryName","paramName","camelCaseParamName","paramValue","param","VueAuthenticate","overrideOptions","token","base64","exp","tokenPath","responseTokenPath","user","provider","providerInstance","OAuth1","vueAuthInstance","VueAuthenticatePlugin","app","axios"],"mappings":"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"}