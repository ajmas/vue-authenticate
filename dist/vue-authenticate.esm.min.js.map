{"version":3,"file":"vue-authenticate.esm.min.js","sources":["../src/utils.js","../src/globals.js","../src/options.js","../src/storage/cookie-storage.js","../src/storage/local-storage.js","../src/storage/memory-storage.js","../src/storage/session-storage.js","../src/storage.js","../src/oauth/popup.js","../src/oauth/oauth1.js","../src/oauth/oauth2.js","../src/authenticate.js","../src/index.js"],"sourcesContent":["if (typeof Object.assign !== 'function') {\n  Object.assign = function (target, varArgs) {\n    'use strict';\n    if (target === null) {\n      throw new TypeError('Cannot convert undefined or null to object');\n    }\n\n    const to = Object(target);\n\n    for (let index = 1; index < arguments.length; index++) {\n      const nextSource = arguments[index];\n\n      if (nextSource !== null) {\n        // Skip over if undefined or null\n        for (const nextKey in nextSource) {\n          // Avoid bugs when hasOwnProperty is shadowed\n          if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n            to[nextKey] = nextSource[nextKey];\n          }\n        }\n      }\n    }\n    return to;\n  };\n}\n\nexport function camelCase (name) {\n  return name.replace(/([\\:\\-\\_]+(.))/g, function (\n    _,\n    separator,\n    letter,\n    offset\n  ) {\n    return offset ? letter.toUpperCase() : letter;\n  });\n}\n\nexport function isUndefined (value) {\n  return typeof value === 'undefined';\n}\n\nexport function isDefined (value) {\n  return typeof value !== 'undefined';\n}\n\nexport function isObject (value) {\n  return value !== null && typeof value === 'object';\n}\n\nexport function isString (value) {\n  return typeof value === 'string';\n}\n\nexport function isNumber (value) {\n  return typeof value === 'number';\n}\n\nexport function isFunction (value) {\n  return typeof value === 'function';\n}\n\nexport function objectExtend (a, b) {\n  // Don't touch 'null' or 'undefined' objects.\n  if (a == null || b == null) {\n    return a;\n  }\n\n  Object.keys(b).forEach(function (key) {\n    if (Object.prototype.toString.call(b[key]) === '[object Object]') {\n      if (Object.prototype.toString.call(a[key]) !== '[object Object]') {\n        a[key] = b[key];\n      } else {\n        a[key] = objectExtend(a[key], b[key]);\n      }\n    } else {\n      a[key] = b[key];\n    }\n  });\n\n  return a;\n}\n\n/**\n * Assemble url from two segments\n *\n * @author Sahat Yalkabov <https://github.com/sahat>\n * @copyright Method taken from https://github.com/sahat/satellizer\n *\n * @param  {String} baseUrl Base url\n * @param  {String} url     URI\n * @return {String}\n */\nexport function joinUrl (baseUrl, url) {\n  if (/^(?:[a-z]+:)?\\/\\//i.test(url)) {\n    return url;\n  }\n  const joined = [baseUrl, url].join('/');\n  const normalize = function (str) {\n    return str\n      .replace(/[\\/]+/g, '/')\n      .replace(/\\/\\?/g, '?')\n      .replace(/\\/\\#/g, '#')\n      .replace(/\\:\\//g, '://');\n  };\n  return normalize(joined);\n}\n\n/**\n * Get full path based on current location\n *\n * @author Sahat Yalkabov <https://github.com/sahat>\n * @copyright Method taken from https://github.com/sahat/satellizer\n *\n * @param  {Location} location\n * @return {String}\n */\nexport function getFullUrlPath (location) {\n  const isHttps = location.protocol === 'https:';\n  return (\n    location.protocol +\n    '//' +\n    location.hostname +\n    ':' +\n    (location.port || (isHttps ? '443' : '80')) +\n    (/^\\//.test(location.pathname)\n      ? location.pathname\n      : '/' + location.pathname)\n  );\n}\n\n/**\n * Parse query string variables\n *\n * @author Sahat Yalkabov <https://github.com/sahat>\n * @copyright Method taken from https://github.com/sahat/satellizer\n *\n * @param  {String} Query string\n * @return {String}\n */\nexport function parseQueryString (str) {\n  const obj = {};\n  let key;\n  let value;\n  (str || '').split('&').forEach(keyValue => {\n    if (keyValue) {\n      value = keyValue.split('=');\n      key = decodeURIComponent(value[0]);\n      obj[key] = value[1] ? decodeURIComponent(value[1]) : true;\n    }\n  });\n  return obj;\n}\n\n/**\n * Decode base64 string\n * @author Sahat Yalkabov <https://github.com/sahat>\n * @copyright Method taken from https://github.com/sahat/satellizer\n *\n * @param  {String} str base64 encoded string\n * @return {Object}\n */\nexport function decodeBase64 (str) {\n  let buffer;\n  if (typeof module !== 'undefined' && module.exports) {\n    try {\n      buffer = require('buffer').Buffer;\n    } catch (err) {\n      // noop\n    }\n  }\n\n  const fromCharCode = String.fromCharCode;\n\n  const reBtou = new RegExp(\n    [\n      '[\\xC0-\\xDF][\\x80-\\xBF]',\n      '[\\xE0-\\xEF][\\x80-\\xBF]{2}',\n      '[\\xF0-\\xF7][\\x80-\\xBF]{3}'\n    ].join('|'),\n    'g'\n  );\n\n  const cbBtou = function (cccc) {\n    switch (cccc.length) {\n    case 4: {\n      const cp =\n            ((0x07 & cccc.charCodeAt(0)) << 18) |\n            ((0x3f & cccc.charCodeAt(1)) << 12) |\n            ((0x3f & cccc.charCodeAt(2)) << 6) |\n            (0x3f & cccc.charCodeAt(3));\n      const offset = cp - 0x10000;\n      return (\n        fromCharCode((offset >>> 10) + 0xd800) +\n            fromCharCode((offset & 0x3ff) + 0xdc00)\n      );\n    }\n    case 3: {\n      return fromCharCode(\n        ((0x0f & cccc.charCodeAt(0)) << 12) |\n              ((0x3f & cccc.charCodeAt(1)) << 6) |\n              (0x3f & cccc.charCodeAt(2))\n      );\n    }\n    default: {\n      return fromCharCode(\n        ((0x1f & cccc.charCodeAt(0)) << 6) | (0x3f & cccc.charCodeAt(1))\n      );\n    }\n    }\n  };\n\n  const btou = function (b) {\n    return b.replace(reBtou, cbBtou);\n  };\n\n  const _decode = buffer\n    ? function (a) {\n      return (a.constructor === buffer.constructor\n        ? a\n        : buffer.Buffer.alloc(a, 'base64')\n      ).toString();\n    }\n    : function (a) {\n      return btou(atob(a));\n    };\n\n  return _decode(\n    String(str)\n      .replace(/[-_]/g, function (m0) {\n        return m0 === '-' ? '+' : '/';\n      })\n      .replace(/[^A-Za-z0-9\\+\\/]/g, '')\n  );\n}\n\nexport function parseCookies (str = '') {\n  if (str.length === 0) return {};\n  const parsed = {};\n  const pattern = new RegExp('\\\\s*;\\\\s*');\n  str.split(pattern).forEach(i => {\n    const [encodedKey, encodedValue] = i.split('=');\n    const key = decodeURIComponent(encodedKey);\n    const value = decodeURIComponent(encodedValue);\n    parsed[key] = value;\n  });\n  return parsed;\n}\n\nexport function formatOptions (options) {\n  const { path, domain, expires, secure } = options;\n  return [\n    typeof path === 'undefined' || path === null ? '' : ';path=' + path,\n    typeof domain === 'undefined' || domain === null ? '' : ';domain=' + domain,\n    typeof expires === 'undefined' || expires === null\n      ? ''\n      : ';expires=' + expires.toUTCString(),\n    typeof secure === 'undefined' || secure === null || secure === false\n      ? ''\n      : ';secure'\n  ].join('');\n}\n\nexport function formatCookie (key, value, options) {\n  return [\n    encodeURIComponent(key),\n    '=',\n    encodeURIComponent(value),\n    formatOptions(options)\n  ].join('');\n}\n\nexport function getObjectProperty (objectRef, propertyName) {\n  let value;\n  let valueRef = objectRef;\n  const propNames = propertyName.split('.');\n\n  for (let i = 0; i < propNames.length; i++) {\n    const key = propNames[i];\n    value = valueRef[key];\n\n    if (isObject(value)) {\n      valueRef = valueRef[key];\n    } else {\n      break;\n    }\n  }\n\n  return value;\n}\n","const fakeDocument = {\n  createElement () { }\n};\n\nconst fakeWindow = {\n  atob () { },\n  open () { },\n  location: {},\n  localStorage: {\n    setItem () { },\n    getItem () { },\n    removeItem () { }\n  },\n  sessionStorage: {\n    setItem () { },\n    getItem () { },\n    removeItem () { }\n  }\n};\n\nexport const $document = (typeof document !== 'undefined')\n  ? document\n  : fakeDocument;\n\nexport const $window = (typeof window !== 'undefined')\n  ? window\n  : fakeWindow;\n","import { isUndefined } from './utils';\nimport { $window } from './globals';\n\nexport function getCookieDomainUrl () {\n  try {\n    return $window.location.hostname;\n  } catch (error) {}\n\n  return '';\n}\n\nexport function getRedirectUri (uri) {\n  try {\n    return !isUndefined(uri)\n      ? `${$window.location.origin}${uri}`\n      : $window.location.origin;\n  } catch (error) {}\n\n  return uri || null;\n}\n\n/**\n * Default configuration\n */\nexport default {\n  baseUrl: null,\n  tokenPath: 'access_token',\n  tokenName: 'token',\n  tokenPrefix: 'vueauth',\n  tokenHeader: 'Authorization',\n  tokenType: 'Bearer',\n  loginUrl: '/auth/login',\n  registerUrl: '/auth/register',\n  logoutUrl: null,\n  storageType: 'localStorage',\n  storageNamespace: 'vue-authenticate',\n  cookieStorage: {\n    domain: getCookieDomainUrl(),\n    path: '/',\n    secure: false\n  },\n  requestDataKey: 'data',\n  responseDataKey: 'data',\n\n  /**\n   * Default request interceptor for Axios library\n   * @context {VueAuthenticate}\n   */\n  bindRequestInterceptor: function ($auth) {\n    const tokenHeader = $auth.options.tokenHeader;\n\n    $auth.$http.interceptors.request.use(config => {\n      if ($auth.isAuthenticated()) {\n        config.headers[tokenHeader] = [\n          $auth.options.tokenType,\n          $auth.getToken()\n        ].join(' ');\n      } else {\n        delete config.headers[tokenHeader];\n      }\n      return config;\n    });\n  },\n\n  providers: {\n    facebook: {\n      name: 'facebook',\n      url: '/auth/facebook',\n      authorizationEndpoint: 'https://www.facebook.com/v10.0/dialog/oauth',\n      redirectUri: getRedirectUri('/'),\n      requiredUrlParams: ['display', 'scope'],\n      scope: ['email'],\n      scopeDelimiter: ',',\n      display: 'popup',\n      oauthType: '2.0',\n      popupOptions: { width: 580, height: 400 }\n    },\n\n    google: {\n      name: 'google',\n      url: '/auth/google',\n      authorizationEndpoint: 'https://accounts.google.com/o/oauth2/auth',\n      redirectUri: getRedirectUri(),\n      requiredUrlParams: ['scope'],\n      optionalUrlParams: ['display'],\n      scope: ['profile', 'email'],\n      scopePrefix: 'openid',\n      scopeDelimiter: ' ',\n      display: 'popup',\n      oauthType: '2.0',\n      popupOptions: { width: 452, height: 633 }\n    },\n\n    github: {\n      name: 'github',\n      url: '/auth/github',\n      authorizationEndpoint: 'https://github.com/login/oauth/authorize',\n      redirectUri: getRedirectUri(),\n      optionalUrlParams: ['scope'],\n      scope: ['user:email'],\n      scopeDelimiter: ' ',\n      oauthType: '2.0',\n      popupOptions: { width: 1020, height: 618 }\n    },\n\n    instagram: {\n      name: 'instagram',\n      url: '/auth/instagram',\n      authorizationEndpoint: 'https://api.instagram.com/oauth/authorize',\n      redirectUri: getRedirectUri(),\n      requiredUrlParams: ['scope'],\n      scope: ['basic'],\n      scopeDelimiter: '+',\n      oauthType: '2.0',\n      popupOptions: { width: null, height: null }\n    },\n\n    twitter: {\n      name: 'twitter',\n      url: '/auth/twitter',\n      authorizationEndpoint: 'https://api.twitter.com/oauth/authenticate',\n      redirectUri: getRedirectUri(),\n      oauthType: '1.0',\n      popupOptions: { width: 495, height: 645 }\n    },\n\n    bitbucket: {\n      name: 'bitbucket',\n      url: '/auth/bitbucket',\n      authorizationEndpoint: 'https://bitbucket.org/site/oauth2/authorize',\n      redirectUri: getRedirectUri('/'),\n      optionalUrlParams: ['scope'],\n      scope: ['email'],\n      scopeDelimiter: ' ',\n      oauthType: '2.0',\n      popupOptions: { width: 1020, height: 618 }\n    },\n\n    linkedin: {\n      name: 'linkedin',\n      url: '/auth/linkedin',\n      authorizationEndpoint: 'https://www.linkedin.com/oauth/v2/authorization',\n      redirectUri: getRedirectUri(),\n      requiredUrlParams: ['state'],\n      scope: ['r_emailaddress'],\n      scopeDelimiter: ' ',\n      state: 'STATE',\n      oauthType: '2.0',\n      popupOptions: { width: 527, height: 582 }\n    },\n\n    live: {\n      name: 'live',\n      url: '/auth/live',\n      authorizationEndpoint: 'https://login.live.com/oauth20_authorize.srf',\n      redirectUri: getRedirectUri(),\n      requiredUrlParams: ['display', 'scope'],\n      scope: ['wl.emails'],\n      scopeDelimiter: ' ',\n      display: 'popup',\n      oauthType: '2.0',\n      popupOptions: { width: 500, height: 560 }\n    },\n\n    oauth1: {\n      name: null,\n      url: '/auth/oauth1',\n      authorizationEndpoint: null,\n      redirectUri: getRedirectUri(),\n      oauthType: '1.0',\n      popupOptions: null\n    },\n\n    oauth2: {\n      name: null,\n      url: '/auth/oauth2',\n      clientId: null,\n      redirectUri: getRedirectUri(),\n      authorizationEndpoint: null,\n      defaultUrlParams: ['response_type', 'client_id', 'redirect_uri'],\n      requiredUrlParams: null,\n      optionalUrlParams: null,\n      scope: null,\n      scopePrefix: null,\n      scopeDelimiter: null,\n      state: null,\n      oauthType: '2.0',\n      popupOptions: null,\n      responseType: 'code',\n      responseParams: {\n        code: 'code',\n        clientId: 'clientId',\n        redirectUri: 'redirectUri'\n      }\n    }\n  }\n};\n","import { $document } from '../globals.js';\nimport { objectExtend, formatCookie, parseCookies } from '../utils.js';\nimport { getCookieDomainUrl } from '../options.js';\n\nclass CookieStorage {\n  constructor (defaultOptions) {\n    this._defaultOptions = objectExtend(\n      {\n        domain: getCookieDomainUrl(),\n        expires: null,\n        path: '/',\n        secure: false\n      },\n      defaultOptions\n    );\n  }\n\n  setItem (key, value) {\n    const options = objectExtend({}, this._defaultOptions);\n    const cookie = formatCookie(key, value, options);\n    this._setCookie(cookie);\n  }\n\n  getItem (key) {\n    const cookies = parseCookies(this._getCookie());\n    return cookies.hasOwnProperty(key) ? cookies[key] : null;\n  }\n\n  removeItem (key) {\n    const value = '';\n    const defaultOptions = objectExtend({}, this._defaultOptions);\n    const options = objectExtend(defaultOptions, {\n      expires: new Date(0)\n    });\n    const cookie = formatCookie(key, value, options);\n    this._setCookie(cookie);\n  }\n\n  _getCookie () {\n    try {\n      return $document.cookie === 'undefined' ? '' : $document.cookie;\n    } catch (error) {}\n\n    return '';\n  }\n\n  _setCookie (cookie) {\n    try {\n      $document.cookie = cookie;\n    } catch (error) {}\n  }\n}\n\nexport default CookieStorage;\n","import { $window } from '../globals.js';\n\nclass LocalStorage {\n  constructor (namespace) {\n    this.namespace = namespace || null;\n  }\n\n  setItem (key, value) {\n    $window.localStorage.setItem(this._getStorageKey(key), value);\n  }\n\n  getItem (key) {\n    return $window.localStorage.getItem(this._getStorageKey(key));\n  }\n\n  removeItem (key) {\n    $window.localStorage.removeItem(this._getStorageKey(key));\n  }\n\n  _getStorageKey (key) {\n    if (this.namespace) {\n      return [this.namespace, key].join('.');\n    }\n    return key;\n  }\n}\n\nexport default LocalStorage;\n","class MemoryStorage {\n  constructor (namespace) {\n    this.namespace = namespace || null;\n    this._storage = {};\n  }\n\n  setItem (key, value) {\n    this._storage[this._getStorageKey(key)] = value;\n  }\n\n  getItem (key) {\n    return this._storage[this._getStorageKey(key)];\n  }\n\n  removeItem (key) {\n    delete this._storage[this._getStorageKey(key)];\n  }\n\n  _getStorageKey (key) {\n    if (this.namespace) {\n      return [this.namespace, key].join('.');\n    }\n    return key;\n  }\n}\n\nexport default MemoryStorage;\n","import { $window } from '../globals.js';\n\nclass SessionStorage {\n  constructor (namespace) {\n    this.namespace = namespace || null;\n  }\n\n  setItem (key, value) {\n    $window.sessionStorage.setItem(this._getStorageKey(key), value);\n  }\n\n  getItem (key) {\n    return $window.sessionStorage.getItem(this._getStorageKey(key));\n  }\n\n  removeItem (key) {\n    $window.sessionStorage.removeItem(this._getStorageKey(key));\n  }\n\n  _getStorageKey (key) {\n    if (this.namespace) {\n      return [this.namespace, key].join('.');\n    }\n    return key;\n  }\n}\n\nexport default SessionStorage;\n","import { $window } from './globals';\nimport CookieStorage from './storage/cookie-storage.js';\nimport LocalStorage from './storage/local-storage.js';\nimport MemoryStorage from './storage/memory-storage.js';\nimport SessionStorage from './storage/session-storage.js';\n\nexport default function StorageFactory (options) {\n  switch (options.storageType) {\n  case 'localStorage':\n    try {\n      $window.localStorage.setItem('testKey', 'test');\n      $window.localStorage.removeItem('testKey');\n      return new LocalStorage(options.storageNamespace);\n    } catch (error) {}\n    break;\n  case 'sessionStorage':\n    try {\n      $window.sessionStorage.setItem('testKey', 'test');\n      $window.sessionStorage.removeItem('testKey');\n      return new SessionStorage(options.storageNamespace);\n    } catch (error) {}\n    break;\n  case 'cookieStorage':\n    return new CookieStorage(options.cookieStorage);\n\n  case 'memoryStorage':\n  default:\n    return new MemoryStorage(options.storageNamespace);\n  }\n}\n","import { $document, $window } from '../globals.js';\nimport {\n  objectExtend,\n  parseQueryString,\n  getFullUrlPath,\n  isUndefined\n} from '../utils.js';\n\n/**\n * OAuth2 popup management class\n *\n * @author Sahat Yalkabov <https://github.com/sahat>\n * @copyright Class mostly taken from https://github.com/sahat/satellizer\n * and adjusted to fit vue-authenticate library\n */\nexport default class OAuthPopup {\n  constructor (url, name, popupOptions) {\n    this.popup = null;\n    this.url = url;\n    this.name = name;\n    this.popupOptions = popupOptions;\n  }\n\n  async open (redirectUri, skipPooling) {\n    try {\n      this.popup = $window.open(this.url, this.name, this._stringifyOptions());\n      if (this.popup && this.popup.focus) {\n        this.popup.focus();\n      }\n\n      if (!skipPooling) {\n        return this.pooling(redirectUri);\n      }\n    } catch (error) {\n      throw new Error('OAuth popup error occurred');\n    }\n  }\n\n  async pooling (redirectUri) {\n    // promise needed here to be able to return result of popup window,\n    // from interval\n    return new Promise((resolve, reject) => {\n      const redirectUriParser = $document.createElement('a');\n      redirectUriParser.href = redirectUri;\n      const redirectUriPath = getFullUrlPath(redirectUriParser);\n\n      let poolingInterval = setInterval(() => {\n        if (\n          !this.popup ||\n          this.popup.closed ||\n          this.popup.closed === undefined\n        ) {\n          clearInterval(poolingInterval);\n          poolingInterval = null;\n          throw new Error('Auth popup window closed');\n        }\n\n        try {\n          const popupWindowPath = getFullUrlPath(this.popup.location);\n\n          if (popupWindowPath === redirectUriPath) {\n            if (this.popup.location.search || this.popup.location.hash) {\n              const query = parseQueryString(\n                this.popup.location.search.substring(1).replace(/\\/$/, '')\n              );\n              const hash = parseQueryString(\n                this.popup.location.hash.substring(1).replace(/[\\/$]/, '')\n              );\n              let params = objectExtend({}, query);\n              params = objectExtend(params, hash);\n\n              if (params.error) {\n                reject(new Error(params.error));\n              } else {\n                resolve(params);\n              }\n\n              clearInterval(poolingInterval);\n              poolingInterval = null;\n              this.popup.close();\n            } else {\n              reject(new Error(\n                'OAuth redirect has occurred but no query or hash parameters were found.'\n              )\n              );\n            }\n          }\n        } catch (error) {\n          // Ignore DOMException: Blocked a frame with origin from accessing a cross-origin frame.\n        }\n      }, 250);\n    });\n  }\n\n  _stringifyOptions () {\n    const options = [];\n    for (const optionKey in this.popupOptions) {\n      if (!isUndefined(this.popupOptions[optionKey])) {\n        options.push(`${optionKey}=${this.popupOptions[optionKey]}`);\n      }\n    }\n    return options.join(',');\n  }\n}\n","import OAuthPopup from './popup.js';\nimport { $window } from '../globals.js';\nimport {\n  objectExtend,\n  joinUrl\n} from '../utils.js';\n\nconst defaultProviderConfig = {\n  name: null,\n  url: null,\n  authorizationEndpoint: null,\n  scope: null,\n  scopePrefix: null,\n  scopeDelimiter: null,\n  redirectUri: null,\n  requiredUrlParams: null,\n  defaultUrlParams: null,\n  oauthType: '1.0',\n  popupOptions: {}\n};\n\nexport default class OAuth {\n  constructor ($http, storage, providerConfig, options) {\n    this.$http = $http;\n    this.storage = storage;\n    this.providerConfig = objectExtend({}, defaultProviderConfig);\n    this.providerConfig = objectExtend(this.providerConfig, providerConfig);\n    this.options = options;\n  }\n\n  /**\n   * Initialize OAuth1 process\n   * @param  {Object} userData User data\n   * @return {Promise}\n   */\n  async init (userData) {\n    this.oauthPopup = new OAuthPopup(\n      'about:blank',\n      this.providerConfig.name,\n      this.providerConfig.popupOptions\n    );\n\n    if (!$window.cordova) {\n      this.oauthPopup.open(this.providerConfig.redirectUri, true);\n    }\n\n    const response = await this.getRequestToken();\n    const popupResponse = await this.openPopup(response);\n    return this.exchangeForToken(popupResponse, userData);\n  }\n\n  /**\n   * Get OAuth1 request token\n   * @return {Promise}\n   */\n  async getRequestToken () {\n    const requestOptions = {};\n    requestOptions.method = 'POST';\n    requestOptions[this.options.requestDataKey] = objectExtend(\n      {},\n      this.providerConfig\n    );\n    requestOptions.withCredentials = this.options.withCredentials;\n    if (this.options.baseUrl) {\n      requestOptions.url = joinUrl(\n        this.options.baseUrl,\n        this.providerConfig.url\n      );\n    } else {\n      requestOptions.url = this.providerConfig.url;\n    }\n\n    return this.$http(requestOptions);\n  }\n\n  /**\n   * Open OAuth1 popup\n   * @param  {Object} response Response object containing request token\n   * @return {Promise}\n   */\n  async openPopup (response) {\n    const url = [\n      this.providerConfig.authorizationEndpoint,\n      this.buildQueryString(response[this.options.responseDataKey])\n    ].join('?');\n\n    this.oauthPopup.popup.location = url;\n    if ($window.cordova) {\n      return this.oauthPopup.open(this.providerConfig.redirectUri);\n    } else {\n      return this.oauthPopup.pooling(this.providerConfig.redirectUri);\n    }\n  }\n\n  /**\n   * Exchange token and token verifier for access token\n   * @param  {Object} oauth    OAuth data containing token and token verifier\n   * @param  {Object} userData User data\n   * @return {Promise}\n   */\n  async exchangeForToken (oauth, userData) {\n    let payload = objectExtend({}, userData);\n    payload = objectExtend(payload, oauth);\n    const requestOptions = {};\n    requestOptions.method = 'POST';\n    requestOptions[this.options.requestDataKey] = payload;\n    requestOptions.withCredentials = this.options.withCredentials;\n    if (this.options.baseUrl) {\n      requestOptions.url = joinUrl(\n        this.options.baseUrl,\n        this.providerConfig.url\n      );\n    } else {\n      requestOptions.url = this.providerConfig.url;\n    }\n    return this.$http(requestOptions);\n  }\n\n  buildQueryString (params) {\n    const parsedParams = [];\n    for (const key in params) {\n      const value = params[key];\n      parsedParams.push(\n        encodeURIComponent(key) + '=' + encodeURIComponent(value)\n      );\n    }\n    return parsedParams.join('&');\n  }\n}\n","import OAuthPopup from './popup.js';\nimport {\n  camelCase,\n  isFunction,\n  isString,\n  objectExtend,\n  joinUrl\n} from '../utils.js';\n\n/**\n * Default provider configuration\n * @type {Object}\n */\nconst defaultProviderConfig = {\n  name: null,\n  url: null,\n  clientId: null,\n  authorizationEndpoint: null,\n  redirectUri: null,\n  scope: null,\n  scopePrefix: null,\n  scopeDelimiter: null,\n  state: null,\n  requiredUrlParams: null,\n  defaultUrlParams: ['response_type', 'client_id', 'redirect_uri'],\n  responseType: 'code',\n  responseParams: {\n    code: 'code',\n    clientId: 'clientId',\n    redirectUri: 'redirectUri'\n  },\n  oauthType: '2.0',\n  popupOptions: {}\n};\n\nexport default class OAuth2 {\n  constructor ($http, storage, providerConfig, options) {\n    this.$http = $http;\n    this.storage = storage;\n    this.providerConfig = objectExtend({}, defaultProviderConfig);\n    this.providerConfig = objectExtend(this.providerConfig, providerConfig);\n    this.options = options;\n  }\n\n  async init (userData) {\n    const stateName = this.providerConfig.name + '_state';\n    if (isFunction(this.providerConfig.state)) {\n      this.storage.setItem(stateName, this.providerConfig.state());\n    } else if (isString(this.providerConfig.state)) {\n      this.storage.setItem(stateName, this.providerConfig.state);\n    }\n\n    const url = [\n      this.providerConfig.authorizationEndpoint,\n      this._stringifyRequestParams()\n    ].join('?');\n\n    const oauthPopup = new OAuthPopup(\n      url,\n      this.providerConfig.name,\n      this.providerConfig.popupOptions\n    );\n\n    const response = await oauthPopup.open(this.providerConfig.redirectUri);\n    if (\n      this.providerConfig.responseType === 'token' ||\n      !this.providerConfig.url\n    ) {\n      return response;\n    }\n\n    if (\n      response.state &&\n      response.state !== this.storage.getItem(stateName)\n    ) {\n      throw new Error(\n        'State parameter value does not match original OAuth request state value'\n      );\n    }\n\n    return this.exchangeForToken(response, userData);\n  }\n\n  /**\n   * Exchange temporary oauth data for access token\n   * @author Sahat Yalkabov <https://github.com/sahat>\n   * @copyright Method taken from https://github.com/sahat/satellizer\n   *\n   * @param  {[type]} oauth    [description]\n   * @param  {[type]} userData [description]\n   * @return {[type]}          [description]\n   */\n  exchangeForToken (oauth, userData) {\n    const payload = objectExtend({}, userData);\n\n    for (const key in this.providerConfig.responseParams) {\n      switch (key) {\n      case 'code':\n        payload[key] = oauth.code;\n        break;\n      case 'clientId':\n        payload[key] = this.providerConfig.clientId;\n        break;\n      case 'redirectUri':\n        payload[key] = this.providerConfig.redirectUri;\n        break;\n      default:\n        payload[key] = oauth[key];\n      }\n    }\n\n    if (oauth.state) {\n      payload.state = oauth.state;\n    }\n\n    let exchangeTokenUrl;\n    if (this.options.baseUrl) {\n      exchangeTokenUrl = joinUrl(this.options.baseUrl, this.providerConfig.url);\n    } else {\n      exchangeTokenUrl = this.providerConfig.url;\n    }\n\n    return this.$http.post(exchangeTokenUrl, payload, {\n      withCredentials: this.options.withCredentials\n    });\n  }\n\n  /**\n   * Stringify oauth params\n   * @author Sahat Yalkabov <https://github.com/sahat>\n   * @copyright Method taken from https://github.com/sahat/satellizer\n   *\n   * @return {String}\n   */\n  _stringifyRequestParams () {\n    const keyValuePairs = [];\n    const paramCategories = [\n      'defaultUrlParams',\n      'requiredUrlParams',\n      'optionalUrlParams'\n    ];\n\n    paramCategories.forEach(categoryName => {\n      if (!this.providerConfig[categoryName]) return;\n      if (!Array.isArray(this.providerConfig[categoryName])) return;\n\n      this.providerConfig[categoryName].forEach(paramName => {\n        const camelCaseParamName = camelCase(paramName);\n        let paramValue = isFunction(this.providerConfig[paramName])\n          ? this.providerConfig[paramName]()\n          : this.providerConfig[camelCaseParamName];\n\n        if (paramName === 'redirect_uri' && !paramValue) return;\n\n        if (paramName === 'state') {\n          const stateName = this.providerConfig.name + '_state';\n          paramValue = encodeURIComponent(this.storage.getItem(stateName));\n        }\n        if (paramName === 'scope' && Array.isArray(paramValue)) {\n          paramValue = paramValue.join(this.providerConfig.scopeDelimiter);\n          if (this.providerConfig.scopePrefix) {\n            paramValue = [this.providerConfig.scopePrefix, paramValue].join(\n              this.providerConfig.scopeDelimiter\n            );\n          }\n        }\n\n        keyValuePairs.push([paramName, paramValue]);\n      });\n    });\n\n    return keyValuePairs\n      .map(param => {\n        return param.join('=');\n      })\n      .join('&');\n  }\n}\n","import { $window } from './globals.js';\nimport {\n  objectExtend,\n  isFunction,\n  joinUrl,\n  decodeBase64,\n  getObjectProperty\n} from './utils.js';\nimport defaultOptions from './options.js';\nimport StorageFactory from './storage.js';\nimport OAuth1 from './oauth/oauth1.js';\nimport OAuth2 from './oauth/oauth2.js';\n\nexport default class VueAuthenticate {\n  constructor ($http, overrideOptions) {\n    let options = objectExtend({}, defaultOptions);\n    options = objectExtend(options, overrideOptions);\n    const storage = StorageFactory(options);\n\n    Object.defineProperties(this, {\n      $http: {\n        get () {\n          return $http;\n        }\n      },\n\n      options: {\n        get () {\n          return options;\n        }\n      },\n\n      storage: {\n        get () {\n          return storage;\n        }\n      },\n\n      tokenName: {\n        get () {\n          if (this.options.tokenPrefix) {\n            return [this.options.tokenPrefix, this.options.tokenName].join('_');\n          } else {\n            return this.options.tokenName;\n          }\n        }\n      }\n    });\n\n    // Setup request interceptors\n    if (\n      this.options.bindRequestInterceptor &&\n      isFunction(this.options.bindRequestInterceptor)\n    ) {\n      this.options.bindRequestInterceptor.call(this, this);\n    } else {\n      throw new Error('Request interceptor must be functions');\n    }\n  }\n\n  /**\n   * Check if user is authenticated\n   * @author Sahat Yalkabov <https://github.com/sahat>\n   * @copyright Method taken from https://github.com/sahat/satellizer\n   * @return {Boolean}\n   */\n  isAuthenticated () {\n    const token = this.storage.getItem(this.tokenName);\n\n    if (token) {\n      // Token is present\n      if (token.split('.').length === 3) {\n        // Token with a valid JWT format XXX.YYY.ZZZ\n        try {\n          // Could be a valid JWT or an access token with the same format\n          const base64Url = token.split('.')[1];\n          const base64 = base64Url.replace('-', '+').replace('_', '/');\n          const exp = JSON.parse($window.atob(base64)).exp;\n          if (typeof exp === 'number') {\n            // JWT with an optonal expiration claims\n            return Math.round(new Date().getTime() / 1000) < exp;\n          }\n        } catch (error) {\n          return true; // Pass: Non-JWT token that looks like JWT\n        }\n      }\n      return true; // Pass: All other tokens\n    }\n    return false;\n  }\n\n  /**\n   * Get token if user is authenticated\n   * @return {String} Authentication token\n   */\n  getToken () {\n    return this.storage.getItem(this.tokenName);\n  }\n\n  /**\n   * Set new authentication token\n   * @param {String|Object} token\n   */\n  setToken (response, tokenPath) {\n    if (response[this.options.responseDataKey]) {\n      response = response[this.options.responseDataKey];\n    }\n\n    const responseTokenPath = tokenPath || this.options.tokenPath;\n    const token = getObjectProperty(response, responseTokenPath);\n\n    if (token) {\n      this.storage.setItem(this.tokenName, token);\n    }\n  }\n\n  getPayload () {\n    const token = this.storage.getItem(this.tokenName);\n\n    if (token && token.split('.').length === 3) {\n      try {\n        const base64Url = token.split('.')[1];\n        const base64 = base64Url.replace('-', '+').replace('_', '/');\n        return JSON.parse(decodeBase64(base64));\n      } catch (error) {}\n    }\n  }\n\n  /**\n   * Login user using email and password\n   * @param  {Object} user           User data\n   * @param  {Object} requestOptions Request options\n   * @return {Promise}               Request promise\n   */\n  async login (user, requestOptions) {\n    requestOptions = requestOptions || {};\n    requestOptions.url = requestOptions.url\n      ? requestOptions.url\n      : joinUrl(this.options.baseUrl, this.options.loginUrl);\n    requestOptions[this.options.requestDataKey] =\n      user || requestOptions[this.options.requestDataKey];\n    requestOptions.method = requestOptions.method || 'POST';\n    requestOptions.withCredentials =\n      requestOptions.withCredentials || this.options.withCredentials;\n\n    const response = this.$http(requestOptions);\n    this.setToken(response);\n    return response;\n  }\n\n  /**\n   * Register new user\n   * @param  {Object} user           User data\n   * @param  {Object} requestOptions Request options\n   * @return {Promise}               Request promise\n   */\n  async register (user, requestOptions) {\n    requestOptions = requestOptions || {};\n    requestOptions.url = requestOptions.url\n      ? requestOptions.url\n      : joinUrl(this.options.baseUrl, this.options.registerUrl);\n    requestOptions[this.options.requestDataKey] =\n      user || requestOptions[this.options.requestDataKey];\n    requestOptions.method = requestOptions.method || 'POST';\n    requestOptions.withCredentials =\n      requestOptions.withCredentials || this.options.withCredentials;\n\n    const response = this.$http(requestOptions);\n    this.setToken(response);\n    return response;\n  }\n\n  /**\n   * Logout current user\n   * @param  {Object} requestOptions  Logout request options object\n   * @return {Promise}                Request promise\n   */\n  async logout (requestOptions) {\n    if (!this.isAuthenticated()) {\n      throw new Error('There is no currently authenticated user');\n    }\n\n    requestOptions = requestOptions || {};\n\n    if (requestOptions.url || this.options.logoutUrl) {\n      requestOptions.url = requestOptions.url\n        ? requestOptions.url\n        : joinUrl(this.options.baseUrl, this.options.logoutUrl);\n      requestOptions.method = requestOptions.method || 'POST';\n      requestOptions[this.options.requestDataKey] =\n        requestOptions[this.options.requestDataKey] || undefined;\n      requestOptions.withCredentials =\n        requestOptions.withCredentials || this.options.withCredentials;\n\n      const response = this.$http(requestOptions);\n      this.storage.removeItem(this.tokenName);\n      return response;\n    } else {\n      this.storage.removeItem(this.tokenName);\n    }\n  }\n\n  /**\n   * Authenticate user using authentication provider\n   *\n   * @param  {String} provider       Provider name\n   * @param  {Object} userData       User data\n   * @param  {Object} options        Options, to override provider config\n   * @return {Promise}               Request promise\n   */\n  async authenticate (provider, userData, options) {\n    let providerConfig = this.options.providers[provider];\n    if (!providerConfig) {\n      throw new Error('Unknown provider');\n    }\n\n    // support any options passed in, but don't modify the upstream\n    // provider config\n    providerConfig = Object.assign({}, providerConfig, options);\n\n    let providerInstance;\n    switch (providerConfig.oauthType) {\n    case '1.0':\n      providerInstance = new OAuth1(\n        this.$http,\n        this.storage,\n        providerConfig,\n        this.options\n      );\n      break;\n    case '2.0':\n      providerInstance = new OAuth2(\n        this.$http,\n        this.storage,\n        providerConfig,\n        this.options\n      );\n      break;\n    default:\n      throw new Error('Invalid OAuth type');\n    }\n\n    const response = providerInstance.init(userData);\n    this.setToken(response, providerConfig.tokenPath);\n\n    if (this.isAuthenticated()) {\n      return response;\n    } else {\n      throw new Error('Authentication failed');\n    }\n  }\n\n  /**\n   * Link user using authentication provider without login\n   *\n   * @param  {String} provider       Provider name\n   * @param  {Object} userData       User data\n   * @param  {Object} options        Options, to override provider config\n   * @return {Promise}               Request promise\n   */\n  async link (provider, userData, options) {\n    let providerConfig = this.options.providers[provider];\n    if (!providerConfig) {\n      throw new Error('Unknown provider');\n    }\n\n    // support any options passed in, but don't modify the upstream\n    // provider config\n    providerConfig = Object.assign({}, providerConfig, options);\n\n    let providerInstance;\n    switch (providerConfig.oauthType) {\n    case '1.0':\n      providerInstance = new OAuth1(\n        this.$http,\n        this.storage,\n        providerConfig,\n        this.options\n      );\n      break;\n    case '2.0':\n      providerInstance = new OAuth2(\n        this.$http,\n        this.storage,\n        providerConfig,\n        this.options\n      );\n      break;\n    default:\n      throw new Error('Invalid OAuth type');\n    }\n\n    let response = providerInstance.init(userData);\n    if (response[this.options.responseDataKey]) {\n      response = response[this.options.responseDataKey];\n    }\n    return response;\n  }\n}\n","import './utils.js';\nimport VueAuthenticate from './authenticate.js';\n\nlet vueAuthInstance;\n\nconst VueAuthenticatePlugin = {\n  install (app, options) {\n    if (!options) {\n      options = {};\n    }\n\n    if (!vueAuthInstance) {\n      let axios = app.config.globalProperties.$http;\n      if (options.axios) {\n        axios = options.axios;\n      } else if (!axios) {\n        throw new Error('No axios instance found, as option or as vue global');\n      }\n\n      vueAuthInstance = new VueAuthenticate(axios, options);\n      app.config.globalProperties.$auth = vueAuthInstance;\n    }\n  }\n};\n\nexport default VueAuthenticatePlugin;\n"],"names":["camelCase","name","replace","_","separator","letter","offset","toUpperCase","isUndefined","value","isObject","isString","isFunction","objectExtend","a","b","Object","keys","forEach","key","prototype","toString","call","joinUrl","baseUrl","url","test","join","getFullUrlPath","location","isHttps","protocol","hostname","port","pathname","parseQueryString","str","obj","split","keyValue","decodeURIComponent","decodeBase64","buffer","module","exports","require","Buffer","err","fromCharCode","String","reBtou","RegExp","cbBtou","cccc","length","charCodeAt","_decode","constructor","alloc","atob","m0","parseCookies","parsed","pattern","i","encodedKey","encodedValue","formatOptions","options","path","domain","expires","secure","toUTCString","formatCookie","encodeURIComponent","getObjectProperty","objectRef","propertyName","valueRef","propNames","assign","target","varArgs","TypeError","to","index","arguments","nextSource","nextKey","hasOwnProperty","fakeDocument","createElement","fakeWindow","open","localStorage","setItem","getItem","removeItem","sessionStorage","$document","document","$window","window","getCookieDomainUrl","error","getRedirectUri","uri","origin","tokenPath","tokenName","tokenPrefix","tokenHeader","tokenType","loginUrl","registerUrl","logoutUrl","storageType","storageNamespace","cookieStorage","requestDataKey","responseDataKey","bindRequestInterceptor","$auth","$http","interceptors","request","use","config","isAuthenticated","headers","getToken","providers","facebook","authorizationEndpoint","redirectUri","requiredUrlParams","scope","scopeDelimiter","display","oauthType","popupOptions","width","height","google","optionalUrlParams","scopePrefix","github","instagram","twitter","bitbucket","linkedin","state","live","oauth1","oauth2","clientId","defaultUrlParams","responseType","responseParams","code","CookieStorage","defaultOptions","this","_defaultOptions","cookie","_setCookie","cookies","_getCookie","Date","LocalStorage","namespace","_getStorageKey","MemoryStorage","_storage","SessionStorage","StorageFactory","OAuthPopup","popup","skipPooling","_stringifyOptions","focus","pooling","Error","Promise","resolve","reject","redirectUriParser","href","redirectUriPath","poolingInterval","setInterval","closed","undefined","clearInterval","query","hash","params","search","substring","close","optionKey","push","defaultProviderConfig","OAuth","storage","providerConfig","userData","oauthPopup","cordova","response","getRequestToken","popupResponse","openPopup","exchangeForToken","requestOptions","method","withCredentials","buildQueryString","oauth","payload","parsedParams","OAuth2","stateName","_stringifyRequestParams","exchangeTokenUrl","post","keyValuePairs","categoryName","Array","isArray","paramName","camelCaseParamName","paramValue","map","param","VueAuthenticate","overrideOptions","defineProperties","get","token","base64Url","base64","exp","JSON","parse","Math","round","getTime","user","setToken","provider","providerInstance","OAuth1","init","vueAuthInstance","VueAuthenticatePlugin","install","app","axios","globalProperties"],"mappings":"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"}